pipeline {
    agent any
    stages {
        stage('Getting Git') {
            steps {
                git branch: 'master', url: 'https://github.com/Harmanjeet3/Maven_Jenkins_project.git'
            }
        }
        stage('Test') {
            steps {
                echo "Test"
            }
        }
        stage('Maven Package') {
            steps {
                sh 'mvn -f Hello_app_maven/pom.xml package'
            }
        }
        stage('deployemnt') {
            steps {
                echo "End"
                sh'''
                ls /var/lib/jenkins/workspace/pipeline_job/
                sudo cp /var/lib/jenkins/workspace/pipeline_job/Hello_app_maven/target/Hello_app_maven.war /opt/webapps/
                sudo /opt/bin/startup.sh 
                
                '''
            }
        }
        stage('Git Push') {
            steps {
                
                sh'''
                
                sudo cp /var/lib/jenkins/workspace/pipeline_job/Hello_app_maven/target/Hello_app_maven.war folder
                sudo mv Hello_app_maven.war Hello_war$(date +%Y%m%d%H%M%S).war
                sudo git add folder
                sudo git commit -m "$(date +%Y%m%d%H%M%S) war "
                sudo git push -u origin main
                
                
                '''
            }
        }
        stage('Ending Process') {
            steps {
                echo "End"
            }
        }
    }
}